{"version":3,"kind":"Article","sha256":"e7f82125b1d9c619789d4eae67daa8e5562579d10b98922b75301fe637196208","slug":"read-based","location":"/metagenomics/Read-based.md","dependencies":[],"frontmatter":{"title":"Read-based profiling","content_includes_title":false,"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/aababc1/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/aababc1/metainsight-book/blob/main/metagenomics/Read-based.md","edit_url":"https://github.com/aababc1/metainsight-book/edit/main/metagenomics/Read-based.md","thumbnail":"/build/b52f136c3368f4f1552e38357183e433.png","exports":[{"format":"md","filename":"Read-based.md","url":"/build/Read-based-d92a82e55daab5fc5a5016aa4814b50d.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The methods for analyzing preprocessed reads can be categorized into two main approaches: read-based profiling and assembly-based profiling.\nRead-based profiling involves taxonomic and functional profiling without the need for assembly, primarily relying on k-mer matching.\nThis approach is particularly useful for analyzing low-depth samples that are challenging to assemble. It offers the advantage of faster analysis completion.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BVw8O9OP3G"}],"key":"FNisRSvxOL"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://huttenhower.sph.harvard.edu/humann/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"HUMAnN 3.0","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TtWpFZjgFF"}],"urlSource":"https://huttenhower.sph.harvard.edu/humann/","key":"spNi7hFjIV"},{"type":"text","value":", for instance, utilizes the MetaPhlAn program for pre-taxonomic profiling.\nIt then employs a translated search to examine unmapped reads, facilitating further analysis and quantification of gene families and pathways across the entire pangenomes.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RWd7skIH0U"}],"key":"trsOWXcpeD"},{"type":"code","lang":"bash","value":"# download database\n$ conda activate humann\n$ humann_databases --download chocophlan full /database/humann\n$ humann_databases --download uniref uniref90_diamond /database/humann\n# concatenate all reads into a single FASTAQ file\n$ cat kneaddata.trimmed.1.fastq kneaddata.trimmed.2.fastq > kneaddata.trimmed.fastq\n# run human 3.0\n$ humann3 --input kneaddata.trimmed.fastq --output humann3_out/ --nucleotide-database /database/humann/chocophlan/ --protein-database /database/humann/uniref/","position":{"start":{"line":10,"column":1},"end":{"line":19,"column":1}},"key":"VC2rXhezfE"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"▶Example of output files","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"SB0W0BlHz3"}],"key":"mcB47ttVwu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"HUMAnN 3.0_genefamilies.tsv","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"NIJYyF9XaC"},{"type":"break","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"BF671qmP98"},{"type":"text","value":": Gene family abundance, calculated as reads per kilobase (RPK) value. If the taxonomy assignment is successful, the contribution value is assigned to each microorganism and divided. Gene families are presented in the first column with the UniRef90 identifier, separated by ‘|’ or labeled as ‘UniRef90_unknown’ if no identifier is available.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"I2I2GCj1Zd"}],"key":"O035IMzlGy"}],"key":"ulwig990SG"}],"key":"r9fLXy9HQY"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/b52f136c3368f4f1552e38357183e433.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"nwPRRct3PW","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_6_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"HWpnxOQYu2"}],"key":"kxgIo2lDqF"}],"key":"bZdhjow6aG"}],"enumerator":"1","key":"BYZrd8cwcN"},{"type":"list","ordered":true,"start":2,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"HUMAnN 3.0_pathabundance.tsv","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"nCp7nziiZ8"},{"type":"break","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"siSRhGQziZ"},{"type":"text","value":": Represents the pathway abundance of each sample and is calculated as an RPK value, the same as the gene family result. It is divided according to the contribution of each microorganism.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"TDsm94ThcF"}],"key":"wfM5KYqkPm"}],"key":"elGFwpNIUy"}],"key":"GUGLH5RQpl"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/61e0ebcf2551844450d66fb571101f78.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"p5yNMLVRwj","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_6_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"TMD20LV9pb"}],"key":"wCRKpfIykD"}],"key":"aOc55KGbKo"}],"enumerator":"2","key":"nEsDKJGdRp"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"To compare gene families across samples with different sequencing depths, normalization can be performed by obtaining relative abundance numbers (relab) or counts per million (CPM), which is the copy number of a gene divided by one million reads.\nThis can be done by specifying cpm or relab in the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"MquUb0hVUZ"},{"type":"inlineCode","value":"--units","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"EnPjrtr4bU"},{"type":"text","value":" option of the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"o2h07swBK6"},{"type":"inlineCode","value":"Human_renorm_table","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"WNgGJ4wr4S"},{"type":"text","value":" command.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"viw1NI47mI"}],"key":"GvXdeoyTAN"},{"type":"code","lang":"bash","value":"# Normalization \n$ humann_renorm_table --input Trimmed_paired_merged_genefamilies.tsv --output Trimmed_paired_merged_genefamilies_relab.tsv --units cpm","position":{"start":{"line":41,"column":1},"end":{"line":44,"column":1}},"key":"XrsKVdWiqa"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/56a10fbe52b054082c5f268cfeb4f003.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"UPkSb82RbW","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_6_3.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"ubranCbdNB"}],"key":"Tfq7TFcYMR"}],"key":"JYCBLDKpBg"}],"enumerator":"3","key":"ND9vO0KvCf"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"After normalization, UniRef gene families can be grouped into reaction units in the default database, MetaCyc, and abundances can be reconstructed.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"dUL27Um0uo"}],"key":"lQEeG6wGLx"},{"type":"code","lang":"bash","value":"# Generate barplot for specific pathway\n$ humann_barplot --input Trimmed_paired_merged_genefamilies_relab.tsv --output plot1.png --focal-feature 2-ISOPROPYLMALATESYN-RXN\n# Generate sorted barplot by total sum of abundances\n$ humann_barplot --input Trimmed_paired_merged_genefamilies_relab.tsv --output plot2_sorted.png --focal-feature 2-ISOPROPYLMALATESYN-RXN -–sort sum \n# Generate sorted barplot by bray-curtis distance and facetted by genera\n$ humann_barplot --input Trimmed_paired_merged_genefamilies_relab.tsv --output plot3_sorted_facetted.png --focal-feature COA-PWY -–sort braycurtis –-as-genera –-remove-zeros","position":{"start":{"line":53,"column":1},"end":{"line":60,"column":1}},"key":"k4wMxaxoqK"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"After grouping by reaction, you can plot specific reactions, sort bar graphs based on the sum of their total abundance, sort bar graphs based on their Bayesian distance, or facet by genera.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"teYy9rOjhq"}],"key":"u2SCphJ1OP"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/386d30845cc192d57619cf061f8eada8.png","alt":"Bar plot for METSYN_PWY (plot1.png)","data":{"altTextIsAutoGenerated":true},"key":"TP3lZos80B","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_6_4.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Bar plot for METSYN_PWY (plot1.png)","key":"G9WaIzWswE"}],"key":"kUDixqqaAe"}],"key":"e91wTluqIa"}],"key":"t3woxp7LPU"}],"enumerator":"4","key":"rhHrvyhHRE"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/a8177289bab9359cd455726f4bbb0bd9.png","alt":"Sorted bar plot for METSYN_PWY (plot1_sorted.png)","data":{"altTextIsAutoGenerated":true},"key":"tClDWYJg7S","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_6_5.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Sorted bar plot for METSYN_PWY (plot1_sorted.png)","key":"CecAwu0Gj7"}],"key":"EVdYi4Fo3Q"}],"key":"ARMCaEOcCg"}],"key":"WYhsjKt7dC"}],"enumerator":"5","key":"l8ZXIGXqtE"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/fd806497daaffe7c5a89a7df05b2ff07.png","alt":"Sorted and facetted bar plot for COA-PWY","data":{"altTextIsAutoGenerated":true},"key":"xGcHeaEJ34","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_6_6.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Sorted and facetted bar plot for COA-PWY","key":"bHBW0OxGmZ"}],"key":"DliEuSUQIh"}],"key":"rhiAvNFxPo"}],"key":"ElTK8CzYSf"}],"enumerator":"6","key":"azJ6sKE53z"}],"key":"MhZYMQkoQU"}],"key":"tE5fHSBr0y"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Functional annotation of contigs","url":"/functional","group":"Metagenomics"},"next":{"title":"Standard Operating Procedure for Next-Generation Sequencing (NGS)-Based Metatranscriptome Analysis","url":"/introduction-1","group":"Metatranscriptomics"}}},"domain":"http://localhost:3000"}