{"version":3,"kind":"Article","sha256":"9458077647256a33b076ca84ea28a2aaec9b46b28c9214f197466e00d9f253f8","slug":"taxonomic","location":"/metagenomics/Taxonomic.md","dependencies":[],"frontmatter":{"title":"Taxonomic annotation of contigs","content_includes_title":false,"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/aababc1/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/aababc1/metainsight-book/blob/main/metagenomics/Taxonomic.md","edit_url":"https://github.com/aababc1/metainsight-book/edit/main/metagenomics/Taxonomic.md","thumbnail":"/metainsight-book/build/201d3bcd8d9e1547a5b3fd4f98408d2a.png","exports":[{"format":"md","filename":"Taxonomic.md","url":"/metainsight-book/build/Taxonomic-be3b2d4775e0b937c6790605be0255a9.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/201d3bcd8d9e1547a5b3fd4f98408d2a.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"JqJun7nX2p","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_8_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"iKqX9YHEPf"}],"key":"G0CLqYOBUx"}],"key":"IcSmtjCsQ4"}],"enumerator":"1","key":"W64Kb00pyc"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Taxonomic profiling of metagenome datasets can be categorized into three main methods. (1) DNA-to-DNA, (2) DNA-to-protein, and (3) DNA-to-marker genes.\nThe commonly used method (1) is similar to BLASTn and uses a genomic database, while (2) is similar to BLASTx and requires a protein database.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"x9XrPCuwvD"}],"key":"ztmLZNNVZg"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/a051d0fcc42449bb9f49cfd39ea0dca6.png","alt":">Comparison of the taxonomic classification tools ; [ref]","data":{"altTextIsAutoGenerated":true},"key":"tfkySK5sZW","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_8_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":">Comparison of the taxonomic classification tools ; ","key":"lIoDUosjaV"},{"type":"cite","url":"https://doi.org/10.1016/j.cell.2019.07.010","children":[{"type":"text","value":"[ref]","key":"gsOrMsM2aN"}],"kind":"narrative","label":"Ye_2019","identifier":"https://doi.org/10.1016/j.cell.2019.07.010","enumerator":"1","key":"uyxnFrAJ4t"}],"key":"pI8a7GgD8l"}],"key":"ag3yPDcpK4"}],"key":"LekrdGng0x"}],"enumerator":"2","key":"L62zOS0DMp"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Each program has its advantages and disadvantages. DNA-to-DNA methods are known for their speed and low memory consumption, but they are generally less sensitive than DNA-to-protein methods.\nConversely, DNA-to-protein methods tend to be slower and more resource-intensive in terms of memory and CPU usage.\nHowever, their advantage lies in their sensitivity and accuracy since they are based on amino acid sequences.\nThe choice of the best program depends on the nature of the data you are analyzing and your database.\nKaiju is one of the representative DNA-to-protein programs, utilizing the NCBI taxonomy and protein reference database for the classification of microorganisms and viruses.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wQ9BkROptr"}],"key":"pNfOOINSL0"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"To run the ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"yWMjn6jq5F"},{"type":"link","url":"https://bioinformatics-centre.github.io/kaiju/","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Kaiju","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"izqsLnTXtz"}],"urlSource":"https://bioinformatics-centre.github.io/kaiju/","key":"zX4jnY6TSM"},{"type":"text","value":" ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"wbeSKNziMu"},{"type":"cite","url":"doi:10.1038/ncomms11257","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Menzel ","key":"zMmrza1Xh3"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"HMWFpPbbZx"}],"key":"uDSBLSRtuQ"},{"type":"text","value":" (2016)","key":"xxzhvi57Rp"}],"kind":"narrative","label":"Menzel_2016","identifier":"doi:10.1038/ncomms11257","enumerator":"2","key":"qRasZyQLE2"},{"type":"text","value":" program, you need to download databases, and the duration of this process may vary based on your computer’s performance.\nThe table below lists the available databases.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"uOVg9FyQFM"}],"key":"M11GFGorXG"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/719aba534d19dbf9057943a569fb5f0c.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"CXimMRKoYg","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_8_3.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"mAS2VtBHIE"}],"key":"jFOYmh9DDO"}],"key":"m2JHjGbX61"}],"enumerator":"3","key":"u8Xpw6ZAxR"},{"type":"code","lang":"bash","value":"# creating the reference database and index from NCBI nr database\n$ conda activate kaiju\n$ kaiju-makedb -s nr","position":{"start":{"line":29,"column":1},"end":{"line":33,"column":1}},"key":"tL07JCRjym"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Files generated after the Makedb command : ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"x5djmXrkE4"},{"type":"inlineCode","value":"Kaiju_db_nr.fmi","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"FqSKXOwwhb"},{"type":"text","value":", ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"VhgAZIoStE"},{"type":"inlineCode","value":"nodes.dmp","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"cK5AT131BG"},{"type":"text","value":", ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"lZ5b6kE8A9"},{"type":"inlineCode","value":"names.dmp","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"nwdwzlBSZI"}],"key":"kPXXBUegAN"},{"type":"code","lang":"bash","value":"$ kaiju -t nodes.dmp -f nr/kaiju_db_nr.fmi -i MEGAHIT_result/final.contigs.fa -o kaiju.out -z 15\n$ kaiju2krona -t nodes.dmp -n names.dmp -i kaiju.out -o kaiju.out.krona\n$ conda deactivate\n$ conda activate krona\n$ ktImportText -o kaiju.out.html kaiju.out.krona\n$ conda deactivate\n$ conda activate kaiju\n$ kaiju2table -t nodes.dmp -n names.dmp -r genus -o kaiju_summary.tsv kaiju.out -l superkingdom,phylum,class,order,family,genus,species\n$ kaiju-addTaxonNames -t nodes.dmp -n names.dmp -i kaiju.out -o kaiju.names.out\n$ conda deactivate","position":{"start":{"line":37,"column":1},"end":{"line":48,"column":1}},"key":"Mgk4L6leI2"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Three options (","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"xzHHJyf1oh"},{"type":"inlineCode","value":"-t","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"hmkC9JC3bU"},{"type":"text","value":", ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"tqyxErm1bG"},{"type":"inlineCode","value":"-f","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"xFmvj9HGMM"},{"type":"text","value":", and ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"eneIVBL5gU"},{"type":"inlineCode","value":"-i","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"TI59Nq5cVN"},{"type":"text","value":") are required to run the kaiju program.\nThe ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"i4QCVVLwf7"},{"type":"inlineCode","value":"-t","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"e4VTFax4WH"},{"type":"text","value":" option requires nodes.dmp, the ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"EXfozUmrQX"},{"type":"inlineCode","value":"-f","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"M0hSGYANQm"},{"type":"text","value":" option requires kaiju_db_nr.fmi, and the ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"eAMM1PsHlP"},{"type":"inlineCode","value":"-i","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"NYcDO9FypY"},{"type":"text","value":" option requires assembled contig file(final.contigs.fa).\nThe ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"v6kUA6ARzV"},{"type":"inlineCode","value":"-o","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"UeSNlzSS7p"},{"type":"text","value":" option sets the name of kaiju’s output file, and the ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"y89kUCisit"},{"type":"inlineCode","value":"-z","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"vMz6CSy8eo"},{"type":"text","value":" option allows you to adjust the number of CPU threads.\nTo visualize the results of kaiju’s analysis, convert the kaiju.out file into an input file for the Krona program with the ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"IbTOwT436P"},{"type":"inlineCode","value":"kaiju2krona","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"AoG35ioTL1"},{"type":"text","value":" command.\nAfter that, you can activate the Krona program and get the visualization result file in html format through the ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"NeT2UUusnF"},{"type":"inlineCode","value":"ktImportText","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"NeZa9mLB1e"},{"type":"text","value":" command.\nThe results of Kaiju’s analysis can also be downloaded as a ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"dMVzpL40Zq"},{"type":"inlineCode","value":"tsv","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"Wtl2Rsj5LV"},{"type":"text","value":" file using the ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"BqAsAu75MJ"},{"type":"inlineCode","value":"kaiju2table","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"QRoAklqp8a"},{"type":"text","value":" command, with the option ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"SkzZRzImwh"},{"type":"inlineCode","value":"-i","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"OvmzYppb8x"},{"type":"text","value":" to specify the rank of the taxon.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"cqpHrG6ik5"}],"key":"sRDIeUQm91"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/5a7cd2de6647b321418de9851a43aad2.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"JaXMKJJbG4","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_8_4.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"GOVXozqzqQ"}],"key":"reCFpDLSao"}],"key":"ivhDs64xRU"}],"enumerator":"4","key":"emViIRyTdu"}],"key":"vW8cjdYyIt"}],"key":"XLPf8UIIwx"},"references":{"cite":{"order":["Ye_2019","Menzel_2016"],"data":{"Ye_2019":{"label":"Ye_2019","enumerator":"1","doi":"10.1016/j.cell.2019.07.010","html":"Ye, S. H., Siddle, K. J., Park, D. J., & Sabeti, P. C. (2019). Benchmarking Metagenomics Tools for Taxonomic Classification. <i>Cell</i>, <i>178</i>(4), 779–794. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/j.cell.2019.07.010\">10.1016/j.cell.2019.07.010</a>","url":"https://doi.org/10.1016/j.cell.2019.07.010"},"Menzel_2016":{"label":"Menzel_2016","enumerator":"2","doi":"10.1038/ncomms11257","html":"Menzel, P., Ng, K. L., & Krogh, A. (2016). Fast and sensitive taxonomic classification for metagenomics with Kaiju. <i>Nature Communications</i>, <i>7</i>(1). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1038/ncomms11257\">10.1038/ncomms11257</a>","url":"https://doi.org/10.1038/ncomms11257"}}}},"footer":{"navigation":{"prev":{"title":"Binning","url":"/binning","group":"Metagenomics"},"next":{"title":"Phylogenetic","url":"/phylogenetic","group":"Metagenomics"}}},"domain":"http://localhost:3000"}