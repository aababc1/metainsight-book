{"version":3,"kind":"Article","sha256":"80dbd9dc21de259d165a20cdbb7286e63e9c7702f04bc57928645d9171bf03bd","slug":"phylogenetic","location":"/metagenomics/phylogenetic.md","dependencies":[],"frontmatter":{"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/aababc1/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/aababc1/metainsight-book/blob/main/metagenomics/phylogenetic.md","edit_url":"https://github.com/aababc1/metainsight-book/edit/main/metagenomics/phylogenetic.md","thumbnail":"/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","exports":[{"format":"md","filename":"phylogenetic.md","url":"/build/phylogenetic-1e0835862d4479e35899c9a7e6bc1ad9.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"# Phylogenomic tree construction of the MAG","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k8qw5on5QB"}],"key":"Z16Jm55Ih2"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"FH49SwDF0t","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"PHBUnI1OiD"}],"key":"JJjA69pGVl"}],"key":"PD76Vt781c"}],"enumerator":"1","key":"TGpbTygXzW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"There are various methods for performing taxonomic assignment after recovering multiple genomes from a metagenome.\nAmong these methods, the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uML1Pe6VAm"},{"type":"link","url":"https://gtdb.ecogenomic.org","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB database","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CiZMmGQLBH"}],"urlSource":"https://gtdb.ecogenomic.org","key":"mIvqqeyDNI"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lAS3S7mLeF"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GJnZT0d6IC"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"w9VYWHf2EE"},{"type":"text","value":", which facilitates classification, are among the most commonly used.\nGTDB is a database that compiles information about metagenome-assembled genomes (MAGs) recovered from diverse environmental samples based on data from RefSeq and GenBank.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"n8fynvK9fu"}],"key":"xz65RoO8CV"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"GTDB-tk consists of multiple steps, including an identification step that utilizes Prodigal and HMMER, an alignment step for concatenating marker genes, and a classification step that involves comparison with the GTDB reference tree using the pplacer program and the maximum-likelihood placement technique.\nAdditionally, a single command, classify_wf, is available to combine these three steps into one streamlined process.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Oxn7zX1OGq"}],"key":"QjORURHsQB"},{"type":"code","lang":"bash","value":"$ conda activate gtdbtk\n# Download GTDB-Tk reference data & set the database PATH\n$ wget https://data.gtdb.ecogenomic.org/releases/latest/auxillary_files/gtdbtk_v2_data.tar.gz\n$ tar xvzf gtdbtk_v2_data.tar.gz\n$ export GTDBTK_DATA_PATH=/path/to/unarchived/gtdbtk/release000\n# run GTDB-tk (gene calling)\n$ gtdbtk identify --genome_dir bins_dir/bin --out_dir /gtdbtk/identify --extension fa --cpus 2\n# run GTDB-tk (align)\n$ gtdbtk align --identify_dir /gtdbtk/identify --out_dir /gtdbtk/align --cpus 2\n# run GTDB-tk (classify)\n$ gtdbtk classify --genome_dir /gtdbtk/genomes --align_dir /gtdbtk/align --out_dir /gtdbtk/classify -x fa --cpus 2\n$ conda deactivate","position":{"start":{"line":15,"column":1},"end":{"line":28,"column":1}},"key":"K1woTso5sr"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/891c837cff04abaf596794c8bc35c23f.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"fEps8QawIu","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"QOWbQ1yhEU"}],"key":"GarCYFjiS7"}],"key":"fjeF3GMIc9"}],"enumerator":"2","key":"Vu9Lz9n6PS"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Besides ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"fjxMdOl0SM"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"PJ3e8csKdH"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"XyRgYtNqqm"},{"type":"text","value":", another widely used program is ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"njcPg8KohX"},{"type":"link","url":"https://huttenhower.sph.harvard.edu/phylophlan","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"PhyloPhlAn","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"GMI6jdLcpN"}],"urlSource":"https://huttenhower.sph.harvard.edu/phylophlan","key":"c8JCCB7ezw"},{"type":"text","value":". This program is known for its accuracy and speed.\nIt enables the characterization and construction of phylogenetic trees for microbial genomes and offers simple visualization options.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"TYtyarnhpR"}],"key":"tO4g3uqhxu"},{"type":"code","lang":"bash","value":"$ conda activate phylophlan3\n$ phylophlan_metagenomic -i bins_dir -o output_metagenomic --nproc 4 -n 1 -d SGB.Jan19 --verbose 2>&1\n$ phylophlan_draw_metagenomic -i output_metagenomic.tsv -o output_heatmap --map bin2meta.tsv --top 20 --verbose 2>&1\n$ conda deactivate","position":{"start":{"line":38,"column":1},"end":{"line":43,"column":1}},"key":"Ut98vXbJtL"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"DH2iXJFaR0"},{"type":"inlineCode","value":"phylophlan_metagenomic","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"qJBj7l5WUC"},{"type":"text","value":" command in PhyloPhlAn 3.0 allows you to assign the closest species-level genome bins (SGBs) for each bin obtained from metagenome assembly analysis.\nWhen using this command, you can adjust the number of CPU threads via the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"YJbgo930cV"},{"type":"inlineCode","value":"-nproc","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Miu6jhCRPW"},{"type":"text","value":" option.\nAdditionally, you can determine the number of SGBs to report for each input bin using the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"ZL8vq6dlsN"},{"type":"inlineCode","value":"-n","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"gVgVnoGsHB"},{"type":"text","value":" option, with a default value of 10.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"gC9rZQGkJ9"}],"key":"C5wE42yMzP"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"This command generates three output files that list SGBs based on the average mash distance of the bins.\nTo visualize the output as a heatmap, you can utilize the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"XhGktGSWXa"},{"type":"inlineCode","value":"phylophlan_draw_metagenomic","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"v50smm28vY"},{"type":"text","value":" command.\nIn this process, a mapping file for the bins entered in the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"GDJOwVfBgZ"},{"type":"inlineCode","value":"--map","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"mFNIzvvG6t"},{"type":"text","value":" option should be in ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"cez0PeYjcz"},{"type":"inlineCode","value":".tsv","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"rGq9gSmi5d"},{"type":"text","value":" file format.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"b8q0rfwTCI"}],"key":"jsh5WyTAq4"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/e883f013045e59b7fc754857e450f463.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"Fzv9Vx5yV4","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_3.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"u0ro8bRl3F"}],"key":"CscftY6X7Y"}],"key":"dQZlmt98eb"}],"enumerator":"3","key":"KxMINCxxhn"}],"key":"Nb44ussvBR"}],"key":"ZZYkjf3o17"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Taxonomic annotation of contigs","url":"/taxonomic","group":"Metagenomics"},"next":{"title":"Functional annotation of contigs","url":"/functional","group":"Metagenomics"}}},"domain":"http://localhost:3000"}