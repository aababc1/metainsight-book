{"version":3,"kind":"Article","sha256":"80dbd9dc21de259d165a20cdbb7286e63e9c7702f04bc57928645d9171bf03bd","slug":"phylogenetic","location":"/metagenomics/phylogenetic.md","dependencies":[],"frontmatter":{"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/your-username/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/your-username/metainsight-book/blob/main/metagenomics/phylogenetic.md","edit_url":"https://github.com/your-username/metainsight-book/edit/main/metagenomics/phylogenetic.md","thumbnail":"/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","exports":[{"format":"md","filename":"phylogenetic.md","url":"/build/phylogenetic-5919c46d8060e5216ba90520032b37d8.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"# Phylogenomic tree construction of the MAG","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jKlAMVEG62"}],"key":"HopiRl2kZm"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"qpdcZIKM3E","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"CFysEITgBJ"}],"key":"cD4HvACRIY"}],"key":"ev4JgAe7a2"}],"enumerator":"1","key":"V0Why5Sj0P"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"There are various methods for performing taxonomic assignment after recovering multiple genomes from a metagenome.\nAmong these methods, the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XcMGJ8Z0MY"},{"type":"link","url":"https://gtdb.ecogenomic.org","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB database","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wF289iqzNT"}],"urlSource":"https://gtdb.ecogenomic.org","key":"lzQc68gpy0"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wzjYlh9SQF"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"toA6WAoRob"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"X0ILQctuJJ"},{"type":"text","value":", which facilitates classification, are among the most commonly used.\nGTDB is a database that compiles information about metagenome-assembled genomes (MAGs) recovered from diverse environmental samples based on data from RefSeq and GenBank.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E7w1xFvvvn"}],"key":"S5rMgdHEnj"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"GTDB-tk consists of multiple steps, including an identification step that utilizes Prodigal and HMMER, an alignment step for concatenating marker genes, and a classification step that involves comparison with the GTDB reference tree using the pplacer program and the maximum-likelihood placement technique.\nAdditionally, a single command, classify_wf, is available to combine these three steps into one streamlined process.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"k3601ZQiV7"}],"key":"F69Bi76bc2"},{"type":"code","lang":"bash","value":"$ conda activate gtdbtk\n# Download GTDB-Tk reference data & set the database PATH\n$ wget https://data.gtdb.ecogenomic.org/releases/latest/auxillary_files/gtdbtk_v2_data.tar.gz\n$ tar xvzf gtdbtk_v2_data.tar.gz\n$ export GTDBTK_DATA_PATH=/path/to/unarchived/gtdbtk/release000\n# run GTDB-tk (gene calling)\n$ gtdbtk identify --genome_dir bins_dir/bin --out_dir /gtdbtk/identify --extension fa --cpus 2\n# run GTDB-tk (align)\n$ gtdbtk align --identify_dir /gtdbtk/identify --out_dir /gtdbtk/align --cpus 2\n# run GTDB-tk (classify)\n$ gtdbtk classify --genome_dir /gtdbtk/genomes --align_dir /gtdbtk/align --out_dir /gtdbtk/classify -x fa --cpus 2\n$ conda deactivate","position":{"start":{"line":15,"column":1},"end":{"line":28,"column":1}},"key":"e5K8gVqxNM"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/891c837cff04abaf596794c8bc35c23f.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"gReor9xtMa","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"jnjxNL5YIJ"}],"key":"KjZO6aRf8u"}],"key":"lj7uoONa0E"}],"enumerator":"2","key":"UGvFOU0xap"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Besides ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"ufsi8SIdcC"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"KQ8oYcjMDn"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"B550JZvi84"},{"type":"text","value":", another widely used program is ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"QXnrSLhyuO"},{"type":"link","url":"https://huttenhower.sph.harvard.edu/phylophlan","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"PhyloPhlAn","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"irnhbJZtHQ"}],"urlSource":"https://huttenhower.sph.harvard.edu/phylophlan","key":"c2xWIf1uuc"},{"type":"text","value":". This program is known for its accuracy and speed.\nIt enables the characterization and construction of phylogenetic trees for microbial genomes and offers simple visualization options.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"E1XReHpjBb"}],"key":"PgTl03LzoT"},{"type":"code","lang":"bash","value":"$ conda activate phylophlan3\n$ phylophlan_metagenomic -i bins_dir -o output_metagenomic --nproc 4 -n 1 -d SGB.Jan19 --verbose 2>&1\n$ phylophlan_draw_metagenomic -i output_metagenomic.tsv -o output_heatmap --map bin2meta.tsv --top 20 --verbose 2>&1\n$ conda deactivate","position":{"start":{"line":38,"column":1},"end":{"line":43,"column":1}},"key":"NP6dgIyiZ1"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"czEl1MBEEt"},{"type":"inlineCode","value":"phylophlan_metagenomic","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"VddCaTfWW7"},{"type":"text","value":" command in PhyloPhlAn 3.0 allows you to assign the closest species-level genome bins (SGBs) for each bin obtained from metagenome assembly analysis.\nWhen using this command, you can adjust the number of CPU threads via the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Cjo3B4BrMr"},{"type":"inlineCode","value":"-nproc","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"wpavRCoNzO"},{"type":"text","value":" option.\nAdditionally, you can determine the number of SGBs to report for each input bin using the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"najrnU4LdT"},{"type":"inlineCode","value":"-n","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"A6yh5VaZsg"},{"type":"text","value":" option, with a default value of 10.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"s5eTem3EOd"}],"key":"rTyFia5ua7"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"This command generates three output files that list SGBs based on the average mash distance of the bins.\nTo visualize the output as a heatmap, you can utilize the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"pmt0Ai1FAs"},{"type":"inlineCode","value":"phylophlan_draw_metagenomic","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"CEazNV2Rst"},{"type":"text","value":" command.\nIn this process, a mapping file for the bins entered in the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"GLjlb2hKNG"},{"type":"inlineCode","value":"--map","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"uXB3Phw6zN"},{"type":"text","value":" option should be in ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"puPKFxcJAZ"},{"type":"inlineCode","value":".tsv","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"cpXI6T1fz8"},{"type":"text","value":" file format.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"LEqLWdKaPL"}],"key":"Wk8BARTmjR"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/e883f013045e59b7fc754857e450f463.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"O4lGI5FCWs","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_3.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"z0TLIs1oRa"}],"key":"jfHdz8lOvP"}],"key":"JDSXvNQ8fm"}],"enumerator":"3","key":"pKWF9pKwZ6"}],"key":"RcYy2BfTCW"}],"key":"Epg80tESpE"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Taxonomic annotation of contigs","url":"/taxonomic","group":"Metagenomics"},"next":{"title":"Functional annotation of contigs","url":"/functional","group":"Metagenomics"}}},"domain":"http://localhost:3000"}