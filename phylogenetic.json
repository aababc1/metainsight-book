{"version":3,"kind":"Article","sha256":"838e1e6df088efa4480f2cb425c8d287b53bd34478c48489db8f3c33ebc2ac6e","slug":"phylogenetic","location":"/metagenomics/phylogenetic.md","dependencies":[],"frontmatter":{"title":"References","content_includes_title":true,"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/aababc1/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/aababc1/metainsight-book/blob/main/metagenomics/phylogenetic.md","edit_url":"https://github.com/aababc1/metainsight-book/edit/main/metagenomics/phylogenetic.md","thumbnail":"/metainsight-book/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","exports":[{"format":"md","filename":"phylogenetic.md","url":"/metainsight-book/build/phylogenetic-54118e2c72c4f7c5f919e450aff45d21.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"# Phylogenomic tree construction of the MAG","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VU2TjST2X9"}],"key":"ASNUTcjPaG"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"IBaRVstQeG","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"DBbczdPuwL"}],"key":"E7GEZvEYJX"}],"key":"R4urIDll2i"}],"enumerator":"1","key":"jey8QzIrTM"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"There are various methods for performing taxonomic assignment after recovering multiple genomes from a metagenome.\nAmong these methods, the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"B76hU5OcSZ"},{"type":"link","url":"https://gtdb.ecogenomic.org","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB database","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HBIQRnvN9t"}],"urlSource":"https://gtdb.ecogenomic.org","key":"OGO86ENHYf"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DX0CIQdKkj"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"H0II3WAYqF"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"UmzIRjxcBg"},{"type":"text","value":", which facilitates classification, are among the most commonly used.\nGTDB is a database that compiles information about metagenome-assembled genomes (MAGs) recovered from diverse environmental samples based on data from RefSeq and GenBank.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OiJMXcIIO3"}],"key":"STzHjATdS4"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"GTDB-tk consists of multiple steps, including an identification step that utilizes Prodigal and HMMER, an alignment step for concatenating marker genes, and a classification step that involves comparison with the GTDB reference tree using the pplacer program and the maximum-likelihood placement technique.\nAdditionally, a single command, classify_wf, is available to combine these three steps into one streamlined process.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UNBXoee8ZM"}],"key":"TFDSFdQbjx"},{"type":"code","lang":"bash","value":"$ conda activate gtdbtk\n# Download GTDB-Tk reference data & set the database PATH\n$ wget https://data.gtdb.ecogenomic.org/releases/latest/auxillary_files/gtdbtk_v2_data.tar.gz\n$ tar xvzf gtdbtk_v2_data.tar.gz\n$ export GTDBTK_DATA_PATH=/path/to/unarchived/gtdbtk/release000\n# run GTDB-tk (gene calling)\n$ gtdbtk identify --genome_dir bins_dir/bin --out_dir /gtdbtk/identify --extension fa --cpus 2\n# run GTDB-tk (align)\n$ gtdbtk align --identify_dir /gtdbtk/identify --out_dir /gtdbtk/align --cpus 2\n# run GTDB-tk (classify)\n$ gtdbtk classify --genome_dir /gtdbtk/genomes --align_dir /gtdbtk/align --out_dir /gtdbtk/classify -x fa --cpus 2\n$ conda deactivate","position":{"start":{"line":15,"column":1},"end":{"line":28,"column":1}},"key":"gQusbNzl8C"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/891c837cff04abaf596794c8bc35c23f.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"lXIXLcSqtf","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"j9neC5dIj7"}],"key":"JrJ9MTW5Zk"}],"key":"u2Prx3Guhl"}],"enumerator":"2","key":"zfYftZ35lt"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Besides ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"J1xcfxc8ZZ"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"tpaSM1ja7V"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"kjUEELTzie"},{"type":"text","value":", another widely used program is ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"eTHt9HQvms"},{"type":"link","url":"https://huttenhower.sph.harvard.edu/phylophlan","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"PhyloPhlAn","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"EF5wJJTmj3"}],"urlSource":"https://huttenhower.sph.harvard.edu/phylophlan","key":"Llmgs0UAac"},{"type":"text","value":". This program is known for its accuracy and speed.\nIt enables the characterization and construction of phylogenetic trees for microbial genomes and offers simple visualization options.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"VRO5xKlt6b"}],"key":"pvqVgzHLz2"},{"type":"code","lang":"bash","value":"$ conda activate phylophlan3\n$ phylophlan_metagenomic -i bins_dir -o output_metagenomic --nproc 4 -n 1 -d SGB.Jan19 --verbose 2>&1\n$ phylophlan_draw_metagenomic -i output_metagenomic.tsv -o output_heatmap --map bin2meta.tsv --top 20 --verbose 2>&1\n$ conda deactivate","position":{"start":{"line":38,"column":1},"end":{"line":43,"column":1}},"key":"ZKxLcKXTii"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"OhN57u4Tvh"},{"type":"inlineCode","value":"phylophlan_metagenomic","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"SF5PLxtxUU"},{"type":"text","value":" command in PhyloPhlAn 3.0 allows you to assign the closest species-level genome bins (SGBs) for each bin obtained from metagenome assembly analysis.\nWhen using this command, you can adjust the number of CPU threads via the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"JCMZjyu55H"},{"type":"inlineCode","value":"-nproc","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"IhLFBVGawm"},{"type":"text","value":" option.\nAdditionally, you can determine the number of SGBs to report for each input bin using the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"JKLdO8rshw"},{"type":"inlineCode","value":"-n","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"iNbWzvlPJf"},{"type":"text","value":" option, with a default value of 10.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"qxxIig7EYC"}],"key":"ZNuRU2L4n2"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"This command generates three output files that list SGBs based on the average mash distance of the bins.\nTo visualize the output as a heatmap, you can utilize the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"Ctgpfycxg0"},{"type":"inlineCode","value":"phylophlan_draw_metagenomic","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"BkJa5WPxIF"},{"type":"text","value":" command.\nIn this process, a mapping file for the bins entered in the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"fLcgiJoDmy"},{"type":"inlineCode","value":"--map","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"svZlzT22nB"},{"type":"text","value":" option should be in ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"MEmysizh7S"},{"type":"inlineCode","value":".tsv","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"wJBSomgrkU"},{"type":"text","value":" file format.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"FVW4nf4zLd"}],"key":"eCzmFrqag9"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/e883f013045e59b7fc754857e450f463.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"WVm6UNI1BE","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_3.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"Ls5demaRYo"}],"key":"guMpjCf8Ip"}],"key":"apHSatLqsj"}],"enumerator":"3","key":"Ar1JIcLj71"},{"type":"heading","depth":1,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"AQhFRntNI3"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"key":"fsrnTw39Iu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":59,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Chaumeil PA, Mussig AJ, Hugenholtz P, et al. GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database. ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"V8iG53BAMX"},{"type":"emphasis","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Bioinformatics","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"ajHqB9STD9"}],"key":"ZhpJY3hz7e"},{"type":"text","value":". 2020;36(6):1925-1927. doi:10.1093/bioinformatics/btz848","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"xGbTY6Ww05"}],"key":"Kj2c4UEsPH"}],"key":"w5d2xWPafJ"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Asnicar F, Thomas AM, Beghini F, et al. Serotype and clonal analysis of pathogenic Listeria monocytogenes strains. ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"M2wRzRoDGJ"},{"type":"emphasis","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Nat Commun","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"C2A75rPiA3"}],"key":"r4q2I7u9wS"},{"type":"text","value":". 2020;11(1):2500. doi:10.1038/s41467-020-16366-7","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"shUsTlki6W"}],"key":"QmiubpEDpe"}],"key":"p264a33ETI"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Asnicar F, Weingart G, Tickle TL, et al. Compact graphical representation of phylogenetic data and metadata with GraPhlAn. ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"OVN3QvZMEO"},{"type":"emphasis","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"PeerJ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ILWz9sIXZk"}],"key":"sq6YIhkSl8"},{"type":"text","value":". 2015;3:e1029. doi:10.7717/peerj.1029","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"f7l6HzqpCa"}],"key":"bGtuenCp3g"}],"key":"qZ7RmoIhoZ"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hyatt D, Chen GL, Locascio PF, et al. Prodigal: prokaryotic gene recognition and translation initiation site identification. ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"qypzKmKM1x"},{"type":"emphasis","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"BMC Bioinformatics","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"wvrvyGVAha"}],"key":"nLa1oyRW9R"},{"type":"text","value":". 2010;11:119. doi:10.1186/1471-2105-11-119","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"nRA2n7Asly"}],"key":"sIc2EDkjSC"}],"key":"Ke6i8Mt9G2"}],"key":"JuT5EhuvR5"}],"key":"I0zrX3EbHm"}],"key":"RbfLXlCRB9"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Taxonomic annotation of contigs","url":"/taxonomic","group":"Metagenomics"},"next":{"title":"Functional annotation of contigs","url":"/functional","group":"Metagenomics"}}},"domain":"http://localhost:3000"}