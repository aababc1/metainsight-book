{"version":3,"kind":"Article","sha256":"b4d13b0e05c6478a0e0d5d14aa8668b01bf5693b3362448a468033d6728fa110","slug":"phylogenetic","location":"/metagenomics/phylogenetic.md","dependencies":[],"frontmatter":{"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/aababc1/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/aababc1/metainsight-book/blob/main/metagenomics/phylogenetic.md","edit_url":"https://github.com/aababc1/metainsight-book/edit/main/metagenomics/phylogenetic.md","thumbnail":"/metainsight-book/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","exports":[{"format":"md","filename":"phylogenetic.md","url":"/metainsight-book/build/phylogenetic-a9e7fd9503568f1cd9a296a8ab1e1e3d.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"# Phylogenomic tree construction of the MAG","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T54gSuXBdf"}],"key":"YgTqKsOFIA"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"Yh5xZvzf0N","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"n46nCrEDaR"}],"key":"MnO6ZXMdbF"}],"key":"O3c5dFMvOq"}],"enumerator":"1","key":"WsZmITj1p8"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"There are various methods for performing taxonomic assignment after recovering multiple genomes from a metagenome.\nAmong these methods, the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tdnAW5Wu8C"},{"type":"link","url":"https://gtdb.ecogenomic.org","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB database","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jl75xezV2x"}],"urlSource":"https://gtdb.ecogenomic.org","key":"CBOzFiX4tB"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OI8gB1M9Fq"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DVCq8V2em5"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"mloszssMMx"},{"type":"text","value":" ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pRbBxWpnhN"},{"type":"cite","url":"doi:10.1093/bioinformatics/btz848","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Chaumeil ","key":"ky5ucWPkdo"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"kjkkNncc1C"}],"key":"NLYjfc6rhj"},{"type":"text","value":" (2019)","key":"rwP7kUvc9w"}],"kind":"narrative","label":"Chaumeil_2019","identifier":"doi:10.1093/bioinformatics/btz848","enumerator":"1","key":"FauU6oz91R"},{"type":"text","value":", which facilitates classification, are among the most commonly used.\nGTDB is a database that compiles information about metagenome-assembled genomes (MAGs) recovered from diverse environmental samples based on data from RefSeq and GenBank.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jIrnbF2mc7"}],"key":"jlaOLOrtbF"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"GTDB-tk consists of multiple steps, including an identification step that utilizes Prodigal and HMMER, an alignment step for concatenating marker genes, and a classification step that involves comparison with the GTDB reference tree using the pplacer program and the maximum-likelihood placement technique.\nAdditionally, a single command, classify_wf, is available to combine these three steps into one streamlined process.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rNmV1S6wSq"}],"key":"eoynT2HGeI"},{"type":"code","lang":"bash","value":"$ conda activate gtdbtk\n# Download GTDB-Tk reference data & set the database PATH\n$ wget https://data.gtdb.ecogenomic.org/releases/latest/auxillary_files/gtdbtk_v2_data.tar.gz\n$ tar xvzf gtdbtk_v2_data.tar.gz\n$ export GTDBTK_DATA_PATH=/path/to/unarchived/gtdbtk/release000\n# run GTDB-tk (gene calling)\n$ gtdbtk identify --genome_dir bins_dir/bin --out_dir /gtdbtk/identify --extension fa --cpus 2\n# run GTDB-tk (align)\n$ gtdbtk align --identify_dir /gtdbtk/identify --out_dir /gtdbtk/align --cpus 2\n# run GTDB-tk (classify)\n$ gtdbtk classify --genome_dir /gtdbtk/genomes --align_dir /gtdbtk/align --out_dir /gtdbtk/classify -x fa --cpus 2\n$ conda deactivate","position":{"start":{"line":15,"column":1},"end":{"line":28,"column":1}},"key":"mWMj2qeVfW"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/891c837cff04abaf596794c8bc35c23f.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"IDtXWJpvwG","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"QV3RsXXzmT"}],"key":"ZL6c83mI1w"}],"key":"i4Rhgj3hbH"}],"enumerator":"2","key":"n0yaoCD7KK"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Besides ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"CfFuYt23nD"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"P8loHR73SD"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"vZRaztQNsv"},{"type":"text","value":" ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"LVHlwwDF7D"},{"type":"cite","url":"doi:10.1093/bioinformatics/btz848","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Chaumeil ","key":"NltXa1IjDg"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"CxXX2o6Oqd"}],"key":"asX6fBFuW5"},{"type":"text","value":" (2019)","key":"FKE2oG5mgT"}],"kind":"narrative","label":"Chaumeil2019GTDB","identifier":"doi:10.1093/bioinformatics/btz848","enumerator":"2","key":"J2NMCF4NWj"},{"type":"text","value":", another widely used program is ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Pf06A2KK5w"},{"type":"link","url":"https://huttenhower.sph.harvard.edu/phylophlan","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"PhyloPhlAn","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Srfu4ZeZGy"}],"urlSource":"https://huttenhower.sph.harvard.edu/phylophlan","key":"Xm4inXEMAD"},{"type":"text","value":". This program is known for its accuracy and speed.\nIt enables the characterization and construction of phylogenetic trees for microbial genomes and offers simple visualization options.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"wjw0r1FjPw"}],"key":"vcNdYw9T9D"},{"type":"code","lang":"bash","value":"$ conda activate phylophlan3\n$ phylophlan_metagenomic -i bins_dir -o output_metagenomic --nproc 4 -n 1 -d SGB.Jan19 --verbose 2>&1\n$ phylophlan_draw_metagenomic -i output_metagenomic.tsv -o output_heatmap --map bin2meta.tsv --top 20 --verbose 2>&1\n$ conda deactivate","position":{"start":{"line":38,"column":1},"end":{"line":43,"column":1}},"key":"BmY27pEm6f"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"V6GgNm7LoZ"},{"type":"inlineCode","value":"phylophlan_metagenomic","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"aZoISyOQnC"},{"type":"text","value":" command in PhyloPhlAn 3.0 allows you to assign the closest species-level genome bins (SGBs) for each bin obtained from metagenome assembly analysis.\nWhen using this command, you can adjust the number of CPU threads via the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"oFZg62DBeo"},{"type":"inlineCode","value":"-nproc","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"tsXG11Kl7g"},{"type":"text","value":" option.\nAdditionally, you can determine the number of SGBs to report for each input bin using the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"CB5CYFRbC4"},{"type":"inlineCode","value":"-n","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"G8Az2pNu7F"},{"type":"text","value":" option, with a default value of 10.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Z3fshP5Wka"}],"key":"PYwEp3eBnI"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"This command generates three output files that list SGBs based on the average mash distance of the bins.\nTo visualize the output as a heatmap, you can utilize the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"DumpNpyfmB"},{"type":"inlineCode","value":"phylophlan_draw_metagenomic","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"MPckuN7R4L"},{"type":"text","value":" command.\nIn this process, a mapping file for the bins entered in the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"emqMJEPqwU"},{"type":"inlineCode","value":"--map","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"c3hd8sJmLg"},{"type":"text","value":" option should be in ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"MKWaGNM5NZ"},{"type":"inlineCode","value":".tsv","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"POLQi2MTZI"},{"type":"text","value":" file format.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"I84aQBswSt"}],"key":"VqYhBEZRUY"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/metainsight-book/build/e883f013045e59b7fc754857e450f463.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"coome7i1Su","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_3.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"j0zpsO0TEW"}],"key":"YEfX6TT4b9"}],"key":"F1TvRdKxMa"}],"enumerator":"3","key":"ZPpuKONGiV"}],"key":"Gllu7WeYgR"}],"key":"lMfYGhUt3b"},"references":{"cite":{"order":["Chaumeil_2019","Chaumeil2019GTDB"],"data":{"Chaumeil_2019":{"label":"Chaumeil_2019","enumerator":"1","doi":"10.1093/bioinformatics/btz848","html":"Chaumeil, P.-A., Mussig, A. J., Hugenholtz, P., & Parks, D. H. (2019). GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database. <i>Bioinformatics</i>, <i>36</i>(6), 1925–1927. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1093/bioinformatics/btz848\">10.1093/bioinformatics/btz848</a>","url":"https://doi.org/10.1093/bioinformatics/btz848"},"Chaumeil2019GTDB":{"label":"Chaumeil2019GTDB","enumerator":"2","doi":"10.1093/bioinformatics/btz848","html":"Chaumeil, P.-A., Mussig, A. J., Hugenholtz, P., & Parks, D. H. (2019). GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database. <i>Bioinformatics</i>, <i>36</i>(6), 1925–1927. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1093/bioinformatics/btz848\">10.1093/bioinformatics/btz848</a>","url":"https://doi.org/10.1093/bioinformatics/btz848"}}}},"footer":{"navigation":{"prev":{"title":"Taxonomic annotation of contigs","url":"/taxonomic","group":"Metagenomics"},"next":{"title":"Functional annotation of contigs","url":"/functional","group":"Metagenomics"}}},"domain":"http://localhost:3000"}