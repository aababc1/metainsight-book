{"version":3,"kind":"Article","sha256":"80dbd9dc21de259d165a20cdbb7286e63e9c7702f04bc57928645d9171bf03bd","slug":"phylogenetic","location":"/metagenomics/phylogenetic.md","dependencies":[],"frontmatter":{"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/aababc1/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/aababc1/metainsight-book/blob/main/metagenomics/phylogenetic.md","edit_url":"https://github.com/aababc1/metainsight-book/edit/main/metagenomics/phylogenetic.md","thumbnail":"/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","exports":[{"format":"md","filename":"phylogenetic.md","url":"/build/phylogenetic-b88f894b1a9fb4067006b18e5a7cca57.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"# Phylogenomic tree construction of the MAG","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"owoA0NXx7J"}],"key":"iYEFn4knv0"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/e6b02b1a697b1a8a415b4b0b36d34ff7.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"WrvzhOMCTZ","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"TUXEBmJkRZ"}],"key":"jur0vcNOJf"}],"key":"yE4rR5JfVt"}],"enumerator":"1","key":"kXmgjT835p"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"There are various methods for performing taxonomic assignment after recovering multiple genomes from a metagenome.\nAmong these methods, the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jcanoJqx9e"},{"type":"link","url":"https://gtdb.ecogenomic.org","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB database","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VIEWx9H9Hy"}],"urlSource":"https://gtdb.ecogenomic.org","key":"oOVhApDdoP"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NnKm6Qj60X"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OwMD9O0Jst"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"WNCecDD0Al"},{"type":"text","value":", which facilitates classification, are among the most commonly used.\nGTDB is a database that compiles information about metagenome-assembled genomes (MAGs) recovered from diverse environmental samples based on data from RefSeq and GenBank.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"X4IzkfLFg1"}],"key":"OfftZYWf6J"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"GTDB-tk consists of multiple steps, including an identification step that utilizes Prodigal and HMMER, an alignment step for concatenating marker genes, and a classification step that involves comparison with the GTDB reference tree using the pplacer program and the maximum-likelihood placement technique.\nAdditionally, a single command, classify_wf, is available to combine these three steps into one streamlined process.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"k4PBfnEZ80"}],"key":"MTfNz5MnVa"},{"type":"code","lang":"bash","value":"$ conda activate gtdbtk\n# Download GTDB-Tk reference data & set the database PATH\n$ wget https://data.gtdb.ecogenomic.org/releases/latest/auxillary_files/gtdbtk_v2_data.tar.gz\n$ tar xvzf gtdbtk_v2_data.tar.gz\n$ export GTDBTK_DATA_PATH=/path/to/unarchived/gtdbtk/release000\n# run GTDB-tk (gene calling)\n$ gtdbtk identify --genome_dir bins_dir/bin --out_dir /gtdbtk/identify --extension fa --cpus 2\n# run GTDB-tk (align)\n$ gtdbtk align --identify_dir /gtdbtk/identify --out_dir /gtdbtk/align --cpus 2\n# run GTDB-tk (classify)\n$ gtdbtk classify --genome_dir /gtdbtk/genomes --align_dir /gtdbtk/align --out_dir /gtdbtk/classify -x fa --cpus 2\n$ conda deactivate","position":{"start":{"line":15,"column":1},"end":{"line":28,"column":1}},"key":"QoeQfuFl9I"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/891c837cff04abaf596794c8bc35c23f.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"JRZt7dvtbA","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"R6bvTboNmp"}],"key":"DGc1INMVbv"}],"key":"AOT3nIxqf7"}],"enumerator":"2","key":"PNY66yRkWs"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Besides ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"ndDlSx1D2r"},{"type":"link","url":"https://ecogenomics.github.io/GTDBTk/index.html","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"GTDB-tk","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"n2CWqhVMOB"}],"urlSource":"https://ecogenomics.github.io/GTDBTk/index.html","key":"YU8jSNJIsQ"},{"type":"text","value":", another widely used program is ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"l2rOeC7SgM"},{"type":"link","url":"https://huttenhower.sph.harvard.edu/phylophlan","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"PhyloPhlAn","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"uEq46UKx5p"}],"urlSource":"https://huttenhower.sph.harvard.edu/phylophlan","key":"C2i3q3UW9k"},{"type":"text","value":". This program is known for its accuracy and speed.\nIt enables the characterization and construction of phylogenetic trees for microbial genomes and offers simple visualization options.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"GXWDlesSrH"}],"key":"Q4z6eJlLFS"},{"type":"code","lang":"bash","value":"$ conda activate phylophlan3\n$ phylophlan_metagenomic -i bins_dir -o output_metagenomic --nproc 4 -n 1 -d SGB.Jan19 --verbose 2>&1\n$ phylophlan_draw_metagenomic -i output_metagenomic.tsv -o output_heatmap --map bin2meta.tsv --top 20 --verbose 2>&1\n$ conda deactivate","position":{"start":{"line":38,"column":1},"end":{"line":43,"column":1}},"key":"TMGix6l6em"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"qEYM7boEVv"},{"type":"inlineCode","value":"phylophlan_metagenomic","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"cLLJqrNQYC"},{"type":"text","value":" command in PhyloPhlAn 3.0 allows you to assign the closest species-level genome bins (SGBs) for each bin obtained from metagenome assembly analysis.\nWhen using this command, you can adjust the number of CPU threads via the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"FPJjN0cAbQ"},{"type":"inlineCode","value":"-nproc","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"YlFJAZaqrn"},{"type":"text","value":" option.\nAdditionally, you can determine the number of SGBs to report for each input bin using the ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Xln7e40wNX"},{"type":"inlineCode","value":"-n","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"XpxZVbbLft"},{"type":"text","value":" option, with a default value of 10.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"V4pWmG6BWO"}],"key":"g9aqOpNQco"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"This command generates three output files that list SGBs based on the average mash distance of the bins.\nTo visualize the output as a heatmap, you can utilize the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"oKqazVXY07"},{"type":"inlineCode","value":"phylophlan_draw_metagenomic","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"BYxYkAXJTL"},{"type":"text","value":" command.\nIn this process, a mapping file for the bins entered in the ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"UEWnKxzH4r"},{"type":"inlineCode","value":"--map","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"hwvNXDGmfQ"},{"type":"text","value":" option should be in ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"HpwhXMyohl"},{"type":"inlineCode","value":".tsv","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"YgMqQlwudk"},{"type":"text","value":" file format.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"AiifHNBtPU"}],"key":"gOj5sbEfVv"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/e883f013045e59b7fc754857e450f463.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"b1zVOvxw8l","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_11_3.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"ITySsvG9tc"}],"key":"efIBaoewPl"}],"key":"vivvIBXSvc"}],"enumerator":"3","key":"kY8ZYCdef3"}],"key":"fnc8F0CRrV"}],"key":"aZXjHt8FFI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Taxonomic annotation of contigs","url":"/taxonomic","group":"Metagenomics"},"next":{"title":"Functional annotation of contigs","url":"/functional","group":"Metagenomics"}}},"domain":"http://localhost:3000"}