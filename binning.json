{"version":3,"kind":"Article","sha256":"2c62257a998170eb378892d8678296f1f92223279c904518dc82847c23934ff9","slug":"binning","location":"/metagenomics/Binning.md","dependencies":[],"frontmatter":{"title":"Binning","content_includes_title":false,"authors":[{"nameParsed":{"literal":"META-Insight Team","given":"META-Insight","family":"Team"},"name":"META-Insight Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/aababc1/metainsight-book","keywords":["metagenomics","metatranscriptomics","metaproteomics","microbiome","bioinformatics"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/aababc1/metainsight-book/blob/main/metagenomics/Binning.md","edit_url":"https://github.com/aababc1/metainsight-book/edit/main/metagenomics/Binning.md","thumbnail":"/build/f226ce7a430a813404ff54147137e120.png","exports":[{"format":"md","filename":"Binning.md","url":"/build/Binning-4416c6e066ba36ebeda68ad50f88fdad.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/f226ce7a430a813404ff54147137e120.png","alt":"","data":{"altTextIsAutoGenerated":true},"key":"rHv9TdeNIQ","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_10_1.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[],"key":"mLNuR6Tmkk"}],"key":"EcxoAMVLhY"}],"key":"s7K5c4nW7P"}],"enumerator":"1","key":"INjQNojYwq"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"In metagenome analysis, binning is the process of grouping contigs based on specific criteria, primarily relying on sequence composition and coverage data.\nBy utilizing a binning program to cluster contigs, it becomes possible to reconstruct complete microbial genomes.\nIn addition to ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"srinf9ADW8"},{"type":"link","url":"https://bitbucket.org/berkeleylab/metabat/src/master/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"MetaBAT2","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"iyvrMfGtWC"}],"urlSource":"https://bitbucket.org/berkeleylab/metabat/src/master/","key":"UVFA3pY8Yj"},{"type":"text","value":" we used, other widely used binning programs are ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"QoyEklyrd6"},{"type":"link","url":"https://sourceforge.net/projects/maxbin/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"MaxBin 2.0","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"E60CHaUXnD"}],"urlSource":"https://sourceforge.net/projects/maxbin/","key":"DU6irXjsO6"},{"type":"text","value":" and ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"eJDzhwVUJ1"},{"type":"link","url":"https://github.com/BinPro/CONCOCT","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"CONCOCT","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"FjJJXNVxqE"}],"urlSource":"https://github.com/BinPro/CONCOCT","error":true,"key":"T0tb8Wi9Y3"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EdPOxQEpdC"}],"key":"Wl05ioicMT"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"To perform binning using MetaBAT2, a sam file with coverage information is required.\nFor short reads data, this can be obtained by using the BBmap script to map the trimmed sequence to the template of the assembled contigs.\nFor long read data, minimap2 is used instead of bbmap to map reads to contig.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dkWXXjAB73"}],"key":"hvGcQ6kiTm"},{"type":"code","lang":"bash","value":"# calculate coverage information from short reads assembly\n$ conda activate bbmap\n$ bbmap.sh in=trimmed.reads_1.fastq in2=trimmed.reads_2.fastq covstats=covstats.txt out=MEGAHIT.sam threads=3 ref=/MEGAHIT_result/final.contigs.fa\n$ conda deactivate \n\n# generate bam file from sam file\n$ conda activate samtools\n$ samtools view -bS -o MEGAHIT.bam MEGAHIT.sam -@ 5\n# sort the bam file\n$ samtools sort MEGAHIT.bam –o MEGAHIT.sorted.bam -@ 5\n$ conda deactivate ","position":{"start":{"line":16,"column":1},"end":{"line":28,"column":1}},"key":"meYpeif22Q"},{"type":"code","lang":"bash","value":"# calculate coverage information  from long reads assembly\n$ conda activate minimap2\n# align host read-filtered read file(N008.aln.unamapped.fq) to assembled contig file(N_008_HiFi.p_ctg.fa)\n$ minimap2 -ax map-hifi N_008_HiFi.p_ctg.fa N008.aln.unmapped.fq > N_008_HiFi.p_ctg_mapped.sam\n$ conda deactivate \n\n# generate bam file from sam file\n$ conda activate samtools\n$ samtools view -bS -o N_008_HiFi.p_ctg_mapped.bam N_008_HiFi.p_ctg_mapped.sam -@ 5\n# sort the bam file\n$ samtools sort N_008_HiFi.p_ctg_mapped.bam -o ","position":{"start":{"line":30,"column":1},"end":{"line":42,"column":1}},"key":"RWyl6osA36"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Compress and index the formed sam file and convert it to a binary bam file.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Kt7CV3ROOT"}],"key":"RZP3n2XCnY"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"When the bam file with coverage information is ready, use the jgi_summarize_bam_contig_depth script provided by MetaBAT2 to generate the final depth.txt file and then perform binning with the assembled contigs.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"NYOEZ4W8m6"}],"key":"iIk9XRgzD4"},{"type":"code","lang":"bash","value":"$ conda activate MetaBAT2\n# generate depth file from bam file\n$ jgi_summarize_bam_contig_depths --outputDepth jgi.depth.txt MEGAHIT.sorted.bam\n# run MetaBAT2\n$ MetaBAT2 -i final.contigs.fa -a jgi.depth.txt -o bins_dir/bin\n$ conda deactivate ","position":{"start":{"line":48,"column":1},"end":{"line":55,"column":1}},"key":"VzKhroQnzB"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"After the completion of binning using MetaBAT2, the quality of the bins is assessed using ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Lkzzu3cfgg"},{"type":"link","url":"https://github.com/Ecogenomics/CheckM","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"CheckM","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"vXXToKcKhp"}],"urlSource":"https://github.com/Ecogenomics/CheckM","error":true,"key":"xLbPgklUeO"},{"type":"text","value":".\nCheckM is a program designed to gauge the quality of genomes recovered from isolates, single cells, or metagenomes.\nThe program furnishes information about phylogenetic lineage, genetic characteristics (such as GC contents and coding density), contamination, completeness, and strain heterogeneity.\nIt accomplishes this by analyzing single-copy genes within the genome.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"y2H9AFK008"}],"key":"Y3dagVAkPN"},{"type":"code","lang":"bash","value":"$ conda activate CheckM\n# download CheckM database from https://data.ace.uq.edu.au/public/CheckM_databases/\n$ export CHECKM_DATA_PATH=/path/to/my_CheckM_data\n# run CheckM\n$ CheckM lineage_wf –x fa bins_dir bins_CheckM","position":{"start":{"line":62,"column":1},"end":{"line":68,"column":1}},"key":"fYGU7VwIgv"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"It displays the marker lineage and the number of marker genes in the generated bin, along with the completeness, contamination, and strain heterogeneity of the constructed genome in the last three columns.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"khI54MKsQt"}],"key":"oWNuVEiz9w"},{"type":"container","children":[{"type":"image","style":{"width":"90%"},"url":"/build/da15a01b208f9d23e45f66e4168fca06.png","alt":"Example of CheckM result","data":{"altTextIsAutoGenerated":true},"key":"aVPgpJxCFX","urlSource":"https://github.com/sujin9819/MetaInsight/blob/main/SOP/MetaGenomic/img/G_10_2.png?raw=true"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Example of CheckM result","key":"x8gqrOGhwv"}],"key":"o3GeIgoOuk"}],"key":"OCJ6zfeBCe"}],"key":"eYU20NUuX5"}],"enumerator":"2","key":"syn6RSJwWw"}],"key":"u7wNCju9KB"}],"key":"Fg22Yc594U"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"De novo assembly","url":"/denovo-assembly","group":"Metagenomics"},"next":{"title":"Taxonomic annotation of contigs","url":"/taxonomic","group":"Metagenomics"}}},"domain":"http://localhost:3000"}